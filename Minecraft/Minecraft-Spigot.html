<!--
title: Minecraft-Spigot
description: Spigot的配置文件解析说明
published: true
date: 2024-01-04T18:18:35.482Z
tags: spigot
editor: ckeditor
dateCreated: 2024-01-02T16:03:02.772Z
-->

<h1>Spigot配置解析</h1>
<p>&nbsp; &nbsp; Spigot是SpigotMC团队基于CraftBukkit制作的一个高性能和修复超多BUG的服务端。</p>
<p>Spigot在其BukkitAPI的基础上添加了很多自己的API接口（Spigot API）</p>
<p>本片文章部分内容来自：<a href="https://www.spigotmc.org/wiki/spigot/">SpigotWiki</a>，<a href="https://github.com/LingLuoyunOS/spigotmc-cn">Spigot 中文开发指南</a></p>
<p>&nbsp;</p>
<p>首先我们先做一下准备工作，生成配置文件</p>
<ol>
  <li>下载由spigotmc提供的构建工具（<a href="https://hub.spigotmc.org/jenkins/job/BuildTools/">BuildTools</a>）</li>
  <li>按照<a href="https://hub.spigotmc.org/jenkins/job/BuildTools/">BuildToolsWiki</a>编写工具启动脚本，例如版本1.20.4，我们需要在脚本中写入<code><strong>java</strong> -jar BuildTools.jar --rev 1.20.4</code></li>
  <li>首次编译等待大概5分钟即可，如果编译时间过长，可以使用“科学上网”</li>
  <li>编译过后我们得到文件“spigot-1.20.4.jar”，将其放入空文件夹</li>
  <li>编写常规启动脚本并启动服务端</li>
  <li>修改eula.txt文件中的eula为true并再次启动服务端</li>
</ol>
<p>&nbsp;</p>
<h1>基本文件结构</h1>
<p>相比较<a href="/Minecraft/Minecraft-Bukkit">CraftBukkit</a>我们会额外得到以下文件</p>
<p>plugins\PluginMetrics</p>
<ul>
  <li>config.yml··························································控制stats相关的配置文件</li>
</ul>
<p>spigot.yml································································Spigot的核心配置文件</p>
<p>&nbsp;</p>
<h1>spigot.yml</h1>
<p>以下是对spigot.yml文件的详细解析</p>
<p>该文件需要配合<a href="/Minecraft/Minecraft-Vanilla">server.properties</a>和<a href="/Minecraft/Minecraft-Bukkit">bukkit.yml</a>一起使用</p>
<h2>settings:（全局配置）</h2>
<h3>是否开启DEBUG模式</h3>
<pre><code class="language-plaintext">debug: false</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;关闭</li>
  <li><strong>true</strong> -&nbsp;开启</li>
</ul>
<blockquote>
  <p>对插件开发和测试会有一些作用，一般建议关闭，在开启的时候会浪费过多的性能来输出文本</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置线程转储无响应的时间</h3>
<pre><code class="language-plaintext">timeout-time: 60</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li>1 - 999 整数型（秒）</li>
</ul>
<blockquote>
  <p>在控制台执行<a href="https://cloud.tencent.com/developer/ask/sof/43446">线程转储</a>之前，服务器应无响应多长时间（以秒为单位），如果已配置，则需要关闭并重新启动服务端</p>
</blockquote>
<p>&nbsp;</p>
<h3>是否允许在服务端崩溃后调用脚本重启服务端</h3>
<pre><code class="language-plaintext">restart-on-crash: true</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;关闭</li>
  <li><strong>true</strong> -&nbsp;开启</li>
</ul>
<blockquote>
  <p>控制发生崩溃时服务器是否会自动尝试重新启动服务器，需要搭配 restart-script: 选项使用，如果你使用面板或其他除脚本之外的启动方式，不建议使用这个功能</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置启动/重启脚本</h3>
<pre><code class="language-plaintext">restart-script: ./start.sh</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li>字符串</li>
</ul>
<blockquote>
  <p>服务器启动脚本的位置。此路径将用于 /restart 命令和崩溃时重新启动（restart-on-crash: true）选项，Windows文件后缀为.bat，Linux为.sh</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置Netty网络连接的线程数</h3>
<pre><code class="language-plaintext">netty-threads: 4</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li>1 - 16 整数型</li>
</ul>
<blockquote>
  <p>一般来说不建议调整该配置，如果你有100名玩家且CPU核心数8个以上个人建议适当增加，最大不建议超过8，如果你使用群组端等代理软件建议根据网络环境设置</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置BOSS生物属性</h3>
<pre><code class="language-plaintext">  attribute:
    maxHealth:
      max: 2048.0
    movementSpeed:
      max: 2048.0
    attackDamage:
      max: 2048.0</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li>maxHealth:·························································生命值</li>
  <li>&nbsp; &nbsp; &nbsp; max: 2048.0··················································最大生命值设定（浮点数）</li>
  <li>movementSpeed:···············································移动速度</li>
  <li>&nbsp; &nbsp; &nbsp; max: 2048.0··················································最大移动速度设定（浮点数）</li>
  <li>attackDamage:···················································攻击伤害</li>
  <li>&nbsp; &nbsp; &nbsp; max: 2048.0··················································最大攻击伤害设定（浮点数）</li>
</ul>
<blockquote>
  <p>这里的设置指的是BOSS生物属性的“上限”并非是强制性固定的数值，比方说某个插件或数据包给末影龙增加10000点攻击或生命，那么末影龙的最大攻击或生命只能被限制在2048，需要手动配置最高上限</p>
</blockquote>
<p>&nbsp;</p>
<h3>是否在日志中记录村民的死亡记录</h3>
<pre><code class="language-plaintext">log-villager-deaths: true</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;关闭</li>
  <li><strong>true</strong> -&nbsp;开启</li>
</ul>
<blockquote>
  <p>记录村民死亡的地点和原因（没了），在大厅或者生电服等村民死亡率比较高的服务器中建议关闭，一般人应该不会吃饱了撑的来日志文件中找被噶掉的村民吧？不会吧，不会吧？</p>
</blockquote>
<p>&nbsp;</p>
<h3>是否在日志中记录被玩家命名过的生物的死亡记录</h3>
<pre><code class="language-plaintext">log-named-deaths: true</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;关闭</li>
  <li><strong>true</strong> -&nbsp;开启</li>
</ul>
<blockquote>
  <p>和上一个选项的意思差不多，一般建议禁止，因为一些插件（如精英怪等）会给生物命名如果开启这个选项可能会造成后台控制台大量刷屏，<a href="https://www.mcbbs.net/thread-1251852-1-1.html">例子</a></p>
</blockquote>
<p>&nbsp;</p>
<h3>是否切换在新玩家加入时实时储存数据</h3>
<pre><code class="language-plaintext">save-user-cache-on-stop-only: false</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;实时储存玩家数据</li>
  <li><strong>true</strong> -&nbsp;只在服务器关闭时或玩家退出时储存数据</li>
</ul>
<blockquote>
  <p>一些对玩家数据（背包，状态，成就）不敏感的服务器（如大厅，游戏等）可以关闭以节省磁盘写入和性能损耗，<mark class="pen-red">但是需要注意服务器崩溃时这些未来得及储存的数据将会丢失</mark></p>
</blockquote>
<p>&nbsp;</p>
<h3>设置移动速度检查的阈值</h3>
<pre><code class="language-plaintext">moved-wrongly-threshold: 0.0625</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>浮点型</li>
</ul>
<blockquote>
  <p>控制 "错误移动 "（超出原版载具或物体的速度）检查的阈值，增加这个数字可以减少服务器上的“橡皮人”的数量，但也有可能被玩家滥用</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置移动过快检查的乘数</h3>
<pre><code class="language-plaintext">moved-too-quickly-multiplier: 10.0</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>浮点型</li>
</ul>
<blockquote>
  <p>控制“移动过快”检查的乘数，这实际上是服务器允许玩家移动的最大速度，这在某些情况下会造成问题，例如大型TNT大炮等</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置玩家重新加入时的数据包优先级排序</h3>
<pre><code class="language-plaintext">player-shuffle: 0</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>整数型</li>
</ul>
<blockquote>
  <p>玩家的数据包处理是根据他们加入的时间来处理的，重新登录会改变你在队列中的优先级，这意味着你的行动会比别人更快，启用这个功能可以防止重新登录时获得优势</p>
  <p>对PVP服务器很有用，这个值是以ticks为单位的，所以20 = 每秒排序一次，设置该值低于100可能会导致性能问题，默认为0</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置存储在usercache.json文件中的玩家最大数量</h3>
<pre><code class="language-plaintext">user-cache-size: 1000</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>整数型</li>
</ul>
<blockquote>
  <p>usercache.json文件一般用来储存玩家的 ID 和 UUID ，如果你的玩家数量超过这个数字那么我也不知道会发生什么，大概率是根据加入时间或者其他规则删除不活跃的玩家</p>
</blockquote>
<p>&nbsp;</p>
<h3>设置客户端服务器列表中显示的玩家名称数量</h3>
<pre><code class="language-plaintext">sample-count: 12</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>整数型</li>
</ul>
<blockquote>
  <p>控制将鼠标悬停在客户端服务器列表中的玩家计数上时显示的（随机选择玩家）玩家名称的数量</p>
</blockquote>
<p>&nbsp;</p>
<h3>是否开启群组端（BungeeCord）支持</h3>
<pre><code class="language-plaintext">bungeecord: false</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li><strong>false</strong> -&nbsp;关闭</li>
  <li><strong>true</strong> -&nbsp;开启</li>
</ul>
<blockquote>
  <p>开启之后建议在<a href="/Minecraft/Minecraft-Spigot">server.properties</a>中“server-ip=”指定BungeeCord端的IP地址，如果是本机（群组端和子服在同一台机器上）应当设置为内网环回地址（127.0.0.1）</p>
</blockquote>
<p>&nbsp;</p>
<h2>messages:（消息输出）</h2>
<pre><code class="language-plaintext">restart: Server is restarting
whitelist: You are not whitelisted on this server!
unknown-command: Unknown command. Type "/help" for help.
server-full: The server is full!
outdated-client: Outdated client! Please use {0}
outdated-server: Outdated server! I'm still on {0}</code></pre>
<p>&nbsp;以下为文本翻译：</p>
<ul>
  <li>restart: 服务器正在重新启动</li>
  <li>whitelist: 您没有被列入此服务器的白名单！</li>
  <li>unknown-command: 未知命令，输入“/help”以获取帮助</li>
  <li>server-full: 服务器已满！</li>
  <li>outdated-client: 客户端版本过低！请使用 {0}</li>
  <li>outdated-server: 服务端版本过低！请使用 {0}</li>
</ul>
<blockquote>
  <p>直接复制翻译文本，限于网站排版等原因，自己一条一条替换即可</p>
</blockquote>
<p>&nbsp;</p>
<h2>world-settings:（世界配置）</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>advancements:（成就）</h2>
<h3>是否禁用成就以及单独禁用某个成就</h3>
<pre><code class="language-plaintext">disable-saving: false
disabled:
- minecraft:story/disabled</code></pre>
<p>&nbsp;以下为具体参数：</p>
<ul>
  <li>disable-saving: false·········································禁用玩家成就系统</li>
  <li>disabled:····························································单独禁用某个成就</li>
  <li>- minecraft:story/disabled································要禁用的成就列表</li>
</ul>
<blockquote>
  <p>&nbsp;</p>
</blockquote>
<p>&nbsp;</p>
<h2>players:（玩家）</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>commands:（指令）</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>config-version:（文件版本）</h2>
<h3>服务端配置文件版本</h3>
<pre><code class="language-plaintext">config-version: 12</code></pre>
<p>以下为具体参数：</p>
<ul>
  <li>整数型</li>
</ul>
<blockquote>
  <p>不要自行更改这个数值，服务端在启动之后会检测这个选项，以更新配置文件结构和选项，原本的配置参数会自动转移到新的配置文件内，因此无需改动</p>
</blockquote>
<p>&nbsp;</p>
<h2>stats:（状态）</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
